<%- include("../../layouts/header.ejs") %>
<%- include("../admin-sidebar.ejs") %>

<div class="col-md-9">
  <div class="dash-right">
    <div class="dash-header">
      <div class="dash-title">
        <h1>Contact Submissions</h1>
      </div>
    </div>

    <table class="table table-bordered table-striped">
      <thead>
        <tr>
          <th>#ID</th>
          <th>Name</th>
          <th>Email</th>
          <th>Phone</th>
          <th>Submitted On</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <% contacts.forEach((contact, index) => { %>
          <tr>
            <td><%= index + 1 %></td>
            <td><%= contact.name %></td>
            <td><%= contact.email %></td>
            <td><%= contact.phone %></td>
            <td>
              <%= new Date(contact.createdAt).toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
              }) %>
            </td>
            <td>
              <button type="button" class="btn btn-info btn-sm mr-1" data-toggle="modal" data-target="#viewModal-<%= contact._id %>">
                <i class="fas fa-eye"></i>
              </button>
              <a href="/contactdelete/<%= contact._id %>" class="btn btn-danger btn-sm">
                <i class="fas fa-trash"></i>
              </a>
            </td>
          </tr>

          <!-- View Modal -->
          <div class="modal fade" id="viewModal-<%= contact._id %>" tabindex="-1" role="dialog" aria-labelledby="viewModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title">View Contact Submission</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  <div class="mb-3">
                    <label><b>Name</b></label>
                    <input type="text" class="form-control" readonly value="<%= contact.name %>">
                  </div>
                  <div class="mb-3">
                    <label><b>Email</b></label>
                    <input type="email" class="form-control" readonly value="<%= contact.email %>">
                  </div>
                  <div class="mb-3">
                    <label><b>Phone</b></label>
                    <input type="text" class="form-control" readonly value="<%= contact.phone %>">
                  </div>
                  <div class="mb-3">
                    <label><b>Message</b></label>
                    <textarea class="form-control" rows="4" readonly><%= contact.message %></textarea>
                  </div>
                  <div class="mb-3">
                    <label><b>Submitted On</b></label>
                    <input type="text" class="form-control" readonly value="<%= new Date(contact.createdAt).toLocaleString() %>">
                  </div>
                </div>
              </div>
            </div>
          </div>
        <% }) %>
      </tbody>
    </table>
  </div>
</div>
</div>
</div>
</section>

<%- include("../../layouts/footer.ejs") %>
